

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="个人博客">
  <meta name="author" content="包打听">
  <meta name="keywords" content="">
  <meta name="description" content="介绍 WebGL(Web图形库)是一个JavaScript API,可在任何兼容的Web浏览器中渲染高性能的交互式3D和2D图形。 函数支持查询http:&#x2F;&#x2F;web.eecs.umich.edu&#x2F;~sugih&#x2F;courses&#x2F;eecs487&#x2F;common&#x2F;notes&#x2F;APITables-zhs.xml 基础内容gl_FragCoord 这个是当前着色器像素点的位置，是一个vec2值,表明了当前像素">
<meta property="og:type" content="article">
<meta property="og:title" content="WebGL的shader编写">
<meta property="og:url" content="https://allknowboy.com/posts/d048c050/index.html">
<meta property="og:site_name" content="Dream使用说明书">
<meta property="og:description" content="介绍 WebGL(Web图形库)是一个JavaScript API,可在任何兼容的Web浏览器中渲染高性能的交互式3D和2D图形。 函数支持查询http:&#x2F;&#x2F;web.eecs.umich.edu&#x2F;~sugih&#x2F;courses&#x2F;eecs487&#x2F;common&#x2F;notes&#x2F;APITables-zhs.xml 基础内容gl_FragCoord 这个是当前着色器像素点的位置，是一个vec2值,表明了当前像素">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/logo.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic01.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic02.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic03.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic04.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic05.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif01.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif02.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic06.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif03.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif04.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif05.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif06.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif07.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif08.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif09.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif10.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic07.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif11.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif12.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif13.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif14.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif15.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif16.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif17.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif18.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif19.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif20.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif21.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif22.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif23.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic08.png">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic20.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic09.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic11.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif25.gif">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic13.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic14.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic15.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic16.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic17.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic19.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic12.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic18.jpg">
<meta property="og:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif26.gif">
<meta property="article:published_time" content="2020-12-29T02:50:45.000Z">
<meta property="article:modified_time" content="2021-01-11T12:04:55.363Z">
<meta property="article:author" content="包打听">
<meta property="article:tag" content="shader">
<meta property="article:tag" content="webgl">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://allknowboy.com/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/logo.jpg">
  
  <title>WebGL的shader编写 - Dream使用说明书</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"allknowboy.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":1260480291,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Dream使用说明书</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="WebGL的shader编写">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-12-29 10:50" pubdate>
        2020年12月29日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      29k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      90 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">WebGL的shader编写</h1>
            
            <div class="markdown-body">
              <h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/logo.jpg" srcset="/img/loading.gif" lazyload></p>
<p>WebGL(Web图形库)是一个JavaScript API,可在任何兼容的Web浏览器中渲染高性能的交互式3D和2D图形。</p>
<h3 id="函数支持查询"><a href="#函数支持查询" class="headerlink" title="函数支持查询"></a>函数支持查询</h3><p><a target="_blank" rel="noopener" href="http://web.eecs.umich.edu/~sugih/courses/eecs487/common/notes/APITables-zhs.xml">http://web.eecs.umich.edu/~sugih/courses/eecs487/common/notes/APITables-zhs.xml</a></p>
<h3 id="基础内容"><a href="#基础内容" class="headerlink" title="基础内容"></a>基础内容</h3><h4 id="gl-FragCoord"><a href="#gl-FragCoord" class="headerlink" title="gl_FragCoord"></a>gl_FragCoord</h4><ul>
<li>这个是当前着色器像素点的位置，是一个vec2值,表明了当前像素点的位置</li>
<li>类似与图片中某一点的像素都有对应的x和y的坐标</li>
</ul>
<h4 id="u-time"><a href="#u-time" class="headerlink" title="u_time"></a>u_time</h4><ul>
<li>一个时间的增量</li>
<li>用来推动整个shader世界的运行</li>
</ul>
<h4 id="u-resolution"><a href="#u-resolution" class="headerlink" title="u_resolution"></a>u_resolution</h4><ul>
<li>设备分辨率</li>
<li>类似与图片的宽度与高度</li>
</ul>
<h4 id="gl-FragColor"><a href="#gl-FragColor" class="headerlink" title="gl_FragColor"></a>gl_FragColor</h4><ul>
<li>片着色器的颜色设置，是一个vec4值</li>
<li>类似修改图片中对应[x,y]坐标中的像素</li>
</ul>
<h3 id="高级内容"><a href="#高级内容" class="headerlink" title="高级内容"></a>高级内容</h3><h4 id="转换区间"><a href="#转换区间" class="headerlink" title="转换区间"></a>转换区间</h4><ul>
<li>原始数值区间是笛卡尔坐标系 x[0 ~ 1], y[0 ~ 1],原点在左下角</li>
<li>当坐标减去一个 vec2(0.5)值 可以转化为x[-0.5, 0.5], y[-0.5, 0.5]，原点在中心</li>
<li>在减去0.5的基础上再乘以2 可以转化为x[-1, 1], y[-1, 1],原点在中心</li>
</ul>
<h3 id="无图Shader实例"><a href="#无图Shader实例" class="headerlink" title="无图Shader实例"></a>无图Shader实例</h3><h4 id="灰色背景"><a href="#灰色背景" class="headerlink" title="灰色背景"></a>灰色背景</h4><ul>
<li>一个简单的灰色背景</li>
<li>【precision mediump float;】为精度描述</li>
<li>【gl_FragColor】为输出片颜色</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.6</span>, <span class="hljs-number">0.6</span>, <span class="hljs-number">0.6</span>);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic01.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="画一个圆"><a href="#画一个圆" class="headerlink" title="画一个圆"></a>画一个圆</h4><ul>
<li>step(edge, x)<ul>
<li>如果x &lt; edge，返回0.0，否则返回1.0</li>
</ul>
</li>
<li>length(x)<ul>
<li>返回矢量x的长度</li>
</ul>
</li>
<li>将小于当前radius的部分涂成黑色 其他涂成白色 实现画出圆</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">circleShape</span><span class="hljs-params">(vec2 position, <span class="hljs-keyword">float</span> radius)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">step</span>(radius, <span class="hljs-built_in">length</span>(position - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>)));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 position = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    <span class="hljs-keyword">float</span> circle = <span class="hljs-built_in">circleShape</span>(position, <span class="hljs-number">0.2</span>);<br>    color = <span class="hljs-built_in">vec3</span>(circle);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color.rgb, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic02.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="画一个矩形"><a href="#画一个矩形" class="headerlink" title="画一个矩形"></a>画一个矩形</h4><ul>
<li>使用vec2(0.5) - size * 0.5 使得矩形的中心点在当前的窗口中心</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">rectShape</span><span class="hljs-params">(vec2 position, vec2 size)</span> </span>&#123;<br>    size = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>) - size * <span class="hljs-number">0.5</span>;<br>    vec2 shaper = <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">step</span>(size.x, position.x), <span class="hljs-built_in">step</span>(size.y, position.y));<br>    shaper *= <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">step</span>(size.x, <span class="hljs-number">1.0</span> - position.x), <span class="hljs-built_in">step</span>(size.y, <span class="hljs-number">1.0</span> - position.y));<br>    <span class="hljs-keyword">return</span> shaper.x * shaper.y;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 position = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    color = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">rectShape</span>(position, <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>)));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color.rgb, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic03.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="画一个多边形"><a href="#画一个多边形" class="headerlink" title="画一个多边形"></a>画一个多边形</h4><ul>
<li>atan和cos为常规的数学库函数</li>
<li>画出的其实为三角形的组合体</li>
<li>当边数很大的时候可以画出光滑圆</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> PI = <span class="hljs-number">3.1415926535</span>;<br><br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">polyShape</span><span class="hljs-params">(vec2 position, <span class="hljs-keyword">float</span> radius, <span class="hljs-keyword">float</span> sides)</span> </span>&#123;<br>	position = position * <span class="hljs-number">2.0</span> - <span class="hljs-number">1.0</span>;<br>	<span class="hljs-keyword">float</span> angle = <span class="hljs-built_in">atan</span>(position.x, position.y);<br>	<span class="hljs-keyword">float</span> slice = PI * <span class="hljs-number">2.0</span> / sides;<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">step</span>(radius, <span class="hljs-built_in">cos</span>(<span class="hljs-built_in">floor</span>(<span class="hljs-number">0.5</span> + angle / slice) * slice - angle) * <span class="hljs-built_in">length</span>(position));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 position = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    color = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">polyShape</span>(position, <span class="hljs-number">0.6</span>, <span class="hljs-number">12.0</span>));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic04.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="移动一个圆"><a href="#移动一个圆" class="headerlink" title="移动一个圆"></a>移动一个圆</h4><ul>
<li>与上文圆的代码基本相同</li>
<li>加入一个translate的二维向量 可以控制圆的位置</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">circleShape</span><span class="hljs-params">(vec2 position, <span class="hljs-keyword">float</span> radius)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">step</span>(radius, <span class="hljs-built_in">length</span>(position - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>)));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    vec2 translate = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">.2</span>, <span class="hljs-number">.1</span>);<br>    coord += translate;<br>    color = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">circleShape</span>(coord, <span class="hljs-number">0.3</span>));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic05.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="运动的圆"><a href="#运动的圆" class="headerlink" title="运动的圆"></a>运动的圆</h4><ul>
<li>x轴做sin函数运动 区间为 -1 到 1</li>
<li>y轴做cos函数运动 区间为 -1 到 1</li>
<li>缩小区间 修改轴心 使得圆绕视窗中心做圆周运动</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">circleShape</span><span class="hljs-params">(vec2 position, <span class="hljs-keyword">float</span> radius)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">step</span>(radius, <span class="hljs-built_in">length</span>(position - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>)));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    vec2 translate = <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time) / <span class="hljs-number">2.0</span>, <span class="hljs-built_in">cos</span>(u_time) / <span class="hljs-number">2.0</span>);<br>    coord += translate * <span class="hljs-number">0.5</span>;<br>    color = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">circleShape</span>(coord, <span class="hljs-number">0.2</span>));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif01.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="放大缩小的圆"><a href="#放大缩小的圆" class="headerlink" title="放大缩小的圆"></a>放大缩小的圆</h4><ul>
<li>图形世界中的各种变换都是由矩阵去完成的</li>
<li>mat2 2维矩阵 控制当前点的缩放</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function">mat2 <span class="hljs-title">scale</span><span class="hljs-params">(vec2 scale)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">mat2</span>(scale.x, <span class="hljs-number">.0</span>, <span class="hljs-number">.0</span>, scale.y);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">circleShape</span><span class="hljs-params">(vec2 position, <span class="hljs-keyword">float</span> radius)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">step</span>(radius, <span class="hljs-built_in">length</span>(position - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>)));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 position = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    position -= <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>);<br>    position = <span class="hljs-built_in">scale</span>(<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time))) * position;<br>    position += <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>);<br>    color = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">circleShape</span>(position, <span class="hljs-number">0.1</span>));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif02.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="旋转矩形"><a href="#旋转矩形" class="headerlink" title="旋转矩形"></a>旋转矩形</h4><ul>
<li>mat2 2维矩阵 控制当前点的旋转</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">rectShape</span><span class="hljs-params">(vec2 position, vec2 size)</span> </span>&#123;<br>    size = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>) - size * <span class="hljs-number">0.5</span>;<br>    vec2 shaper = <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">step</span>(size.x, position.x), <span class="hljs-built_in">step</span>(size.y, position.y));<br>    shaper *= <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">step</span>(size.x, <span class="hljs-number">1.0</span> - position.x), <span class="hljs-built_in">step</span>(size.y, <span class="hljs-number">1.0</span> - position.y));<br>    <span class="hljs-keyword">return</span> shaper.x * shaper.y;<br>&#125;<br><br><span class="hljs-function">mat2 <span class="hljs-title">rotate</span><span class="hljs-params">(<span class="hljs-keyword">float</span> angle)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">mat2</span>(<span class="hljs-built_in">cos</span>(angle), -<span class="hljs-built_in">sin</span>(angle), <span class="hljs-built_in">sin</span>(angle), <span class="hljs-built_in">cos</span>(angle));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    coord -= <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>);<br>    coord = <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0.3</span>) * coord;<br>    coord += <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>);<br>    color = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">rectShape</span>(coord, <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.3</span>, <span class="hljs-number">0.3</span>)));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic06.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="迷幻波系列"><a href="#迷幻波系列" class="headerlink" title="迷幻波系列"></a>迷幻波系列</h4><ul>
<li>使用sin和cos函数加上时间变量产生各种奇幻的波纹 </li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    color += <span class="hljs-built_in">cos</span>(coord.x * <span class="hljs-built_in">sin</span>(u_time / <span class="hljs-number">30.0</span>) * <span class="hljs-number">60.0</span>) + <span class="hljs-built_in">cos</span>(coord.y * <span class="hljs-built_in">sin</span>(u_time / <span class="hljs-number">15.0</span>) * <span class="hljs-number">10.0</span>);<br>    color += <span class="hljs-built_in">sin</span>(coord.x * <span class="hljs-built_in">cos</span>(u_time / <span class="hljs-number">30.0</span>) * <span class="hljs-number">60.0</span>) + <span class="hljs-built_in">sin</span>(coord.y * <span class="hljs-built_in">cos</span>(u_time / <span class="hljs-number">15.0</span>) * <span class="hljs-number">10.0</span>);<br>    color += <span class="hljs-built_in">sin</span>(u_time / <span class="hljs-number">10.0</span>) * <span class="hljs-number">0.5</span>;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif03.gif" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = <span class="hljs-number">6.0</span> * gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> n = <span class="hljs-number">1</span>; n &lt; <span class="hljs-number">8</span>; n++) &#123;<br>        <span class="hljs-keyword">float</span> i = <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(n);<br>        coord += <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.7</span> / i * <span class="hljs-built_in">sin</span>(i * coord.y + u_time + <span class="hljs-number">0.3</span> * i) + <span class="hljs-number">0.8</span>, <span class="hljs-number">0.4</span> / i * <span class="hljs-built_in">sin</span>(coord.x + u_time + <span class="hljs-number">0.3</span> * i) + <span class="hljs-number">1.6</span>);<br>    &#125;<br>    <span class="hljs-comment">// coord *= vec2(0.7 / sin(coord.y + u_time +0.3) + 0.8, 0.4 / sin(coord.x + u_time +0.3) +1.6);</span><br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.5</span> * <span class="hljs-built_in">sin</span>(coord.x) + <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span> * <span class="hljs-built_in">sin</span>(coord.y) + <span class="hljs-number">0.5</span>, <span class="hljs-built_in">sin</span>(coord.x + coord.y));<br><br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif04.gif" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> AMOUNT = <span class="hljs-number">12</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = <span class="hljs-number">20.0</span> * (gl_FragCoord.xy - u_resolution / <span class="hljs-number">2.0</span>) / <span class="hljs-built_in">min</span>(u_resolution.x, u_resolution.y);<br>    <span class="hljs-keyword">float</span> len;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; AMOUNT; i++) &#123;<br>        len = <span class="hljs-built_in">length</span>(<span class="hljs-built_in">vec2</span>(coord.x, coord.y));<br>        coord.x -= <span class="hljs-built_in">cos</span>(coord.y + <span class="hljs-built_in">sin</span>(len)) + <span class="hljs-built_in">cos</span>(u_time / <span class="hljs-number">9.0</span>);<br>        coord.y += <span class="hljs-built_in">sin</span>(coord.y + <span class="hljs-built_in">cos</span>(len)) + <span class="hljs-built_in">sin</span>(u_time / <span class="hljs-number">12.0</span>);<br>    &#125;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(<span class="hljs-built_in">cos</span>(len * <span class="hljs-number">2.4</span>), <span class="hljs-built_in">cos</span>(len * <span class="hljs-number">3.2</span>), <span class="hljs-built_in">cos</span>(len * <span class="hljs-number">1.3</span>), <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif05.gif" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">float</span> color = <span class="hljs-number">.0</span>;<br>    color += <span class="hljs-built_in">sin</span>(coord.x * <span class="hljs-number">50.0</span> + <span class="hljs-built_in">cos</span>(u_time + coord.y * <span class="hljs-number">10.0</span> + <span class="hljs-built_in">sin</span>(coord.x * <span class="hljs-number">50.0</span> + u_time))) * <span class="hljs-number">2.0</span>;<br>    color += <span class="hljs-built_in">cos</span>(coord.x * <span class="hljs-number">20.0</span> + <span class="hljs-built_in">sin</span>(u_time + coord.y * <span class="hljs-number">10.0</span> + <span class="hljs-built_in">cos</span>(coord.x * <span class="hljs-number">50.0</span> + u_time))) * <span class="hljs-number">2.0</span>;<br>    color += <span class="hljs-built_in">sin</span>(coord.x * <span class="hljs-number">30.0</span> + <span class="hljs-built_in">cos</span>(u_time + coord.y * <span class="hljs-number">10.0</span> + <span class="hljs-built_in">sin</span>(coord.x * <span class="hljs-number">50.0</span> + u_time))) * <span class="hljs-number">2.0</span>;<br>    color += <span class="hljs-built_in">cos</span>(coord.x * <span class="hljs-number">40.0</span> + <span class="hljs-built_in">sin</span>(u_time + coord.y * <span class="hljs-number">10.0</span> + <span class="hljs-built_in">cos</span>(coord.x * <span class="hljs-number">50.0</span> + u_time))) * <span class="hljs-number">2.0</span>;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color + coord.y, color + coord.x, color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif06.gif" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">float</span> color = <span class="hljs-number">.0</span>;<br>    color += <span class="hljs-built_in">sin</span>(coord.x * <span class="hljs-number">6.0</span> + <span class="hljs-built_in">sin</span>(u_time + coord.y * <span class="hljs-number">90.0</span> + <span class="hljs-built_in">cos</span>(coord.x * <span class="hljs-number">30.0</span> + u_time * <span class="hljs-number">2.0</span>))) * <span class="hljs-number">0.5</span>;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color + coord.x, color + coord.x, color , <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif07.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="彩虹漩涡"><a href="#彩虹漩涡" class="headerlink" title="彩虹漩涡"></a>彩虹漩涡</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    <span class="hljs-keyword">float</span> angle = <span class="hljs-built_in">atan</span>(-coord.y + <span class="hljs-number">0.25</span>, coord.x - <span class="hljs-number">0.5</span>) * <span class="hljs-number">0.1</span>;<br>    <span class="hljs-keyword">float</span> len = <span class="hljs-built_in">length</span>(coord - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.25</span>));<br>    color.r += <span class="hljs-built_in">sin</span>(len * <span class="hljs-number">40.0</span> + angle * <span class="hljs-number">30.0</span> + u_time);<br>    color.g += <span class="hljs-built_in">cos</span>(len * <span class="hljs-number">30.0</span> + angle * <span class="hljs-number">60.0</span> - u_time);<br>    color.b += <span class="hljs-built_in">sin</span>(len * <span class="hljs-number">50.0</span> + angle * <span class="hljs-number">50.0</span> + <span class="hljs-number">3.0</span>);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif08.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="横向扫描线"><a href="#横向扫描线" class="headerlink" title="横向扫描线"></a>横向扫描线</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">1.0</span>);<br>    <span class="hljs-keyword">float</span> size = <span class="hljs-number">20.0</span>;<br>    <span class="hljs-keyword">float</span> alpha = <span class="hljs-built_in">sin</span>(<span class="hljs-built_in">floor</span>(coord.x * size) + u_time * <span class="hljs-number">4.0</span>) + <span class="hljs-number">0.5</span>;<br>    color.r = coord.x;<br>    color.g = coord.y;<br>    color.b = coord.x * coord.y;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, alpha);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif09.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="移动光球"><a href="#移动光球" class="headerlink" title="移动光球"></a>移动光球</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = (gl_FragCoord.xy * <span class="hljs-number">2.0</span> - u_resolution) / <span class="hljs-built_in">min</span>(u_resolution.x, u_resolution.y);<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    coord.x += <span class="hljs-built_in">sin</span>(u_time) + <span class="hljs-built_in">cos</span>(u_time * <span class="hljs-number">2.1</span>);<br>    coord.y += <span class="hljs-built_in">cos</span>(u_time) + <span class="hljs-built_in">sin</span>(u_time * <span class="hljs-number">2.1</span>);<br>    color += <span class="hljs-number">0.1</span> * <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">sin</span>(u_time) + <span class="hljs-number">0.1</span>) / <span class="hljs-built_in">length</span>(coord);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif10.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="光圈"><a href="#光圈" class="headerlink" title="光圈"></a>光圈</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = (gl_FragCoord.xy / u_resolution);<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    vec2 translate = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">-0.5</span>, <span class="hljs-number">-0.5</span>);<br>    coord += translate;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">40</span>; i++) &#123;<br>        <span class="hljs-keyword">float</span> radius = <span class="hljs-number">0.3</span>;<br>        <span class="hljs-keyword">float</span> rad = <span class="hljs-built_in">radians</span>(<span class="hljs-number">360.0</span> / <span class="hljs-number">40.0</span>) * <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(i);<br>        color += <span class="hljs-number">0.003</span> /<span class="hljs-built_in">length</span>(coord + <span class="hljs-built_in">vec2</span>(radius * <span class="hljs-built_in">cos</span>(rad), radius * <span class="hljs-built_in">sin</span>(rad)));<br>    &#125;<br><br>    <br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic07.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="格子光斑"><a href="#格子光斑" class="headerlink" title="格子光斑"></a>格子光斑</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy * <span class="hljs-number">1.0</span> - u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br><br>    color += <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">cos</span>(coord.x / <span class="hljs-number">10.0</span>) + <span class="hljs-built_in">sin</span>(coord.y / <span class="hljs-number">10.0</span>) - <span class="hljs-built_in">cos</span>(u_time));<br><br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif11.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="金属格子光束"><a href="#金属格子光束" class="headerlink" title="金属格子光束"></a>金属格子光束</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">random2d</span><span class="hljs-params">(vec2 coord)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">sin</span>(<span class="hljs-built_in">dot</span>(coord.xy, <span class="hljs-built_in">vec2</span>(<span class="hljs-number">12.9898</span>, <span class="hljs-number">78.233</span>))) * <span class="hljs-number">43758.5453</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy * <span class="hljs-number">0.1</span>;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    coord -= u_time + <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(coord.y), <span class="hljs-built_in">cos</span>(coord.x));<br>    <span class="hljs-keyword">float</span> rand01 = <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">random2d</span>(<span class="hljs-built_in">floor</span>(coord)) + u_time / <span class="hljs-number">60.0</span>);<br>    <span class="hljs-keyword">float</span> rand02 = <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">random2d</span>(<span class="hljs-built_in">floor</span>(coord)) + u_time / <span class="hljs-number">40.0</span>);<br>    rand01 *= <span class="hljs-number">0.4</span> - <span class="hljs-built_in">length</span>(<span class="hljs-built_in">fract</span>(coord));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(rand01 * <span class="hljs-number">4.0</span>, rand02 * rand01 * <span class="hljs-number">4.0</span>, <span class="hljs-number">.0</span>, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif12.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="彩色光球"><a href="#彩色光球" class="headerlink" title="彩色光球"></a>彩色光球</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    vec2 translate = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">-0.5</span>);<br>    coord += translate;<br>    color.r += <span class="hljs-built_in">abs</span>(<span class="hljs-number">0.1</span> + <span class="hljs-built_in">length</span>(coord) - <span class="hljs-number">0.6</span> * <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">sin</span>(u_time * <span class="hljs-number">0.9</span> / <span class="hljs-number">12.0</span>)));<br>    color.g += <span class="hljs-built_in">abs</span>(<span class="hljs-number">0.1</span> + <span class="hljs-built_in">length</span>(coord) - <span class="hljs-number">0.6</span> * <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">sin</span>(u_time * <span class="hljs-number">0.6</span> / <span class="hljs-number">4.0</span>)));<br>    color.b += <span class="hljs-built_in">abs</span>(<span class="hljs-number">0.1</span> + <span class="hljs-built_in">length</span>(coord) - <span class="hljs-number">0.6</span> * <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">sin</span>(u_time * <span class="hljs-number">0.3</span> / <span class="hljs-number">2.0</span>)));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0.1</span> / color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif13.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="基础噪音"><a href="#基础噪音" class="headerlink" title="基础噪音"></a>基础噪音</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_nouse;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">nouse1d</span><span class="hljs-params">(<span class="hljs-keyword">float</span> value)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">cos</span>(value + <span class="hljs-built_in">cos</span>(value * <span class="hljs-number">90.0</span>) * <span class="hljs-number">100.0</span>) * <span class="hljs-number">0.5</span> + <span class="hljs-number">0.5</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    color.r += <span class="hljs-built_in">nouse1d</span>(u_time);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif14.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="白噪音"><a href="#白噪音" class="headerlink" title="白噪音"></a>白噪音</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">random2d</span><span class="hljs-params">(vec2 coord)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">sin</span>(<span class="hljs-built_in">dot</span>(coord.xy, <span class="hljs-built_in">vec2</span>(<span class="hljs-number">12.9898</span>, <span class="hljs-number">78.233</span>))) * <span class="hljs-number">43758.5453</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    <span class="hljs-keyword">float</span> grain = <span class="hljs-number">.0</span>;<br>    grain = <span class="hljs-built_in">random2d</span>(<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(coord))* u_time) ;<br>    color = <span class="hljs-built_in">vec3</span>(grain);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif15.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="变换背景"><a href="#变换背景" class="headerlink" title="变换背景"></a>变换背景</h4><ul>
<li>在一些游戏中可以充当一个变换的背景</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.5</span> + <span class="hljs-number">0.5</span> * <span class="hljs-built_in">cos</span>(u_time + coord.xyx + <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">4.0</span>)));<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif16.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="变换液体"><a href="#变换液体" class="headerlink" title="变换液体"></a>变换液体</h4><ul>
<li>在一些游戏中可以充当一个变换的背景</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">roundLookingBlob</span><span class="hljs-params">(vec2 fragCoord, vec2 tPos, <span class="hljs-keyword">float</span> r)</span> </span>&#123;<br>    vec2 pos = fragCoord.xy / u_resolution.yy - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>);<br>    pos.x -= ((u_resolution.x- u_resolution.y) / u_resolution.y)/<span class="hljs-number">2.0</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">max</span>(<span class="hljs-number">1.0</span>-<span class="hljs-built_in">length</span>(pos-tPos), <span class="hljs-number">0.0</span>) , r);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>	<span class="hljs-keyword">float</span> v = <span class="hljs-number">0.0</span> <br>        + <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy * <span class="hljs-number">0.2</span>,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time)* <span class="hljs-number">2.0</span>, <span class="hljs-built_in">cos</span>(u_time)*<span class="hljs-number">0.004</span>), <span class="hljs-number">10.0</span>)<br>    	+ <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.6</span>)*<span class="hljs-number">0.2</span>, <span class="hljs-built_in">cos</span>(u_time)*<span class="hljs-number">0.3</span>), <span class="hljs-number">7.0</span>)<br>    	+ <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(u_time*<span class="hljs-number">0.8</span>)*<span class="hljs-number">0.3</span>, <span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">1.1</span>)*<span class="hljs-number">0.04</span>), <span class="hljs-number">5.0</span>)<br>    	+ <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(u_time*<span class="hljs-number">0.2</span>)*<span class="hljs-number">0.2</span>, <span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.9</span>)*<span class="hljs-number">0.05</span>), <span class="hljs-number">8.0</span>)<br>    	+ <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(u_time*<span class="hljs-number">1.2</span>)*<span class="hljs-number">0.2</span>, <span class="hljs-number">2.0</span> *<span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.9</span>)*<span class="hljs-number">0.05</span>), <span class="hljs-number">8.0</span>)<br>        + <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(u_time*<span class="hljs-number">0.3</span>)*<span class="hljs-number">0.4</span>, <span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">1.1</span>)*<span class="hljs-number">0.4</span>), <span class="hljs-number">5.0</span>)<br>    	+ <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.6</span>)*<span class="hljs-number">0.9</span>, <span class="hljs-built_in">cos</span>(u_time)*<span class="hljs-number">0.3</span>), <span class="hljs-number">7.0</span>)<br>    	+ <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.6</span>)*<span class="hljs-number">0.3</span>, <span class="hljs-built_in">cos</span>(u_time)*<span class="hljs-number">0.8</span>), <span class="hljs-number">7.0</span>)<br>        + <span class="hljs-built_in">roundLookingBlob</span>(gl_FragCoord.xy,<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(u_time*<span class="hljs-number">0.3</span>)*<span class="hljs-number">0.9</span>, <span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.1</span>)*<span class="hljs-number">0.4</span>), <span class="hljs-number">3.0</span>)<br>        ;<br>    v = <span class="hljs-built_in">clamp</span>((v<span class="hljs-number">-0.5</span>)*<span class="hljs-number">1000.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>);<br>    <span class="hljs-keyword">float</span> r = <br>        <span class="hljs-number">-1.0</span> * <span class="hljs-number">1.0</span> *<span class="hljs-built_in">sin</span>(u_time) <br>        - <span class="hljs-number">2.0</span>* <span class="hljs-built_in">cos</span>(<span class="hljs-number">1.0</span> * u_time) * gl_FragCoord.x / u_resolution.x * gl_FragCoord.y / u_resolution.y;<br>    <span class="hljs-keyword">float</span> g = <span class="hljs-number">0.0</span> - <span class="hljs-number">0.5</span> * <span class="hljs-built_in">cos</span>(<span class="hljs-number">2.0</span> * u_time) *  gl_FragCoord.y / u_resolution.y;<br>    <span class="hljs-keyword">float</span> b = <span class="hljs-number">4.0</span> + <span class="hljs-built_in">sin</span>(u_time) - g + <span class="hljs-number">0.8</span>;<br>	gl_FragColor = <span class="hljs-built_in">vec4</span>(r * v, v * g, v * b, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif17.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="光影圆球"><a href="#光影圆球" class="headerlink" title="光影圆球"></a>光影圆球</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec4 color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0</span>);<br>    vec3 u = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">2.</span> * gl_FragCoord.xy - u_resolution.xy, u_resolution.y) / <span class="hljs-number">3e2</span>;<br>    u = <span class="hljs-built_in">normalize</span>(<span class="hljs-built_in">vec3</span>(u.xy, <span class="hljs-built_in">sqrt</span>(<span class="hljs-built_in">max</span>(u.z * u.z - <span class="hljs-built_in">dot</span>(u.xy, u.xy) * <span class="hljs-number">2.</span>, <span class="hljs-number">0.</span>))));<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;<br>        <span class="hljs-keyword">float</span> l = <span class="hljs-built_in">length</span>(u);<br>        u.xz += <span class="hljs-built_in">sin</span>(u.z + u_time * <span class="hljs-number">.2</span> + l);<br>        u.y += <span class="hljs-built_in">cos</span>(u.x + u_time *<span class="hljs-number">.6</span>);<br>        color += <span class="hljs-built_in">cos</span>(l + <span class="hljs-built_in">vec4</span>(<span class="hljs-number">.3</span>, <span class="hljs-number">.1</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>));<br>    &#125;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif18.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="彩色格子"><a href="#彩色格子" class="headerlink" title="彩色格子"></a>彩色格子</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec4 color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0</span>);<br>    vec3 u = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">2.</span> * gl_FragCoord.xy - u_resolution.xy, u_resolution.y) / <span class="hljs-number">3e2</span>;<br>    u = <span class="hljs-built_in">normalize</span>(<span class="hljs-built_in">vec3</span>(u.xy, <span class="hljs-built_in">sqrt</span>(<span class="hljs-built_in">max</span>(u.z * u.z - <span class="hljs-built_in">dot</span>(u.xy, u.xy) * <span class="hljs-number">2.</span>, <span class="hljs-number">0.</span>))));<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;<br>        <span class="hljs-keyword">float</span> l = <span class="hljs-built_in">length</span>(u);<br>        u.xz += <span class="hljs-built_in">sin</span>(u.z + u_time * <span class="hljs-number">.2</span> + l);<br>        u.y += <span class="hljs-built_in">cos</span>(u.x + u_time *<span class="hljs-number">.6</span>);<br>        color += <span class="hljs-built_in">cos</span>(l + <span class="hljs-built_in">vec4</span>(<span class="hljs-number">.3</span>, <span class="hljs-number">.1</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>));<br>    &#125;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif19.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="绿色细胞"><a href="#绿色细胞" class="headerlink" title="绿色细胞"></a>绿色细胞</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function">vec2 <span class="hljs-title">N22</span><span class="hljs-params">(vec2 point)</span> </span>&#123;<br>    vec3 a = <span class="hljs-built_in">fract</span>(point.xyx * <span class="hljs-built_in">vec3</span>(<span class="hljs-number">123.45</span>, <span class="hljs-number">234.34</span>, <span class="hljs-number">345.65</span>));<br>    a += <span class="hljs-built_in">dot</span>(a, a + <span class="hljs-number">34.45</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">vec2</span>(a.x * a.y, a.y * a.z));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// Zooms out so it goes from -1.0 to 1.0</span><br>    vec2 uv = (<span class="hljs-number">2.0</span> * gl_FragCoord.xy - u_resolution.xy) / u_resolution.y;<br>    <span class="hljs-keyword">float</span> m = <span class="hljs-number">0.0</span>;<br>    <span class="hljs-keyword">float</span> time = u_time * <span class="hljs-number">0.5</span>;<br>    <span class="hljs-keyword">float</span> cellIndex = <span class="hljs-number">0.0</span>;<br>    <span class="hljs-comment">// Initialize minDist at a large distance</span><br>    <span class="hljs-keyword">float</span> minDist = <span class="hljs-number">100.0</span>;<br>    <br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.0</span>);<br>    <br>    <span class="hljs-comment">// Multiply uv</span><br>    uv *= <span class="hljs-number">2.0</span>;<br><br>    <span class="hljs-comment">// Make grid</span><br>    vec2 gridUv = <span class="hljs-built_in">fract</span>(uv) - <span class="hljs-number">0.5</span>;<br><br>    <span class="hljs-comment">// Determine grid cell</span><br>    vec2 id = <span class="hljs-built_in">floor</span>(uv);<br><br>    vec2 cellId = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">float</span> y = <span class="hljs-number">-1.0</span>; y &lt;= <span class="hljs-number">1.0</span>; y++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">float</span> x = <span class="hljs-number">-1.0</span>; x &lt;= <span class="hljs-number">1.0</span>; x++) &#123;<br>            vec2 offset = <span class="hljs-built_in">vec2</span>(x, y);<br>            vec2 n = <span class="hljs-built_in">N22</span>(<span class="hljs-built_in">vec2</span>(id + offset));<br>            vec2 point = offset + <span class="hljs-built_in">sin</span>(n * time) * <span class="hljs-number">0.5</span> ;<br><br>            point -= gridUv;<br>            <span class="hljs-comment">// Euclidian distance</span><br>            <span class="hljs-keyword">float</span> eDist = <span class="hljs-built_in">length</span>(point);<br><br>            <span class="hljs-comment">// Manhattan distance</span><br>            <span class="hljs-keyword">float</span> mDist = <span class="hljs-built_in">abs</span>(point.x) + <span class="hljs-built_in">abs</span>(point.y);<br><br>            <span class="hljs-comment">// Interpolate between distances</span><br>            <span class="hljs-comment">//float dist = mix(eDist, mDist, 0.5);</span><br>            <span class="hljs-keyword">float</span> dist = eDist;<br><br>            <span class="hljs-keyword">if</span> (dist &lt; minDist) &#123; <br>                minDist = dist;<br>                cellId = id + offset;<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-comment">// Visualize gridUv</span><br>        <span class="hljs-comment">//color.rb = gridUv;</span><br>        <br>        color = <span class="hljs-built_in">vec3</span>(minDist);<br>        color.rb = cellId * <span class="hljs-number">0.01</span>;<br>        <span class="hljs-comment">//color *= vec3(0.75, 0.3, 1.0);</span><br>    &#125;<br>    <br>    <span class="hljs-comment">//vec3 color = vec3(minDist);   </span><br> 	<span class="hljs-comment">//vec3 color = vec3(cellIndex/50.0);   </span><br><br>    <span class="hljs-comment">// Output to screen</span><br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color,<span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif20.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="萤火虫"><a href="#萤火虫" class="headerlink" title="萤火虫"></a>萤火虫</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">rand</span><span class="hljs-params">( vec2 c )</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">fract</span>( <span class="hljs-built_in">sin</span>( <span class="hljs-built_in">dot</span>( c.xy, <span class="hljs-built_in">vec2</span>( <span class="hljs-number">12.9898</span>, <span class="hljs-number">78.233</span> ) ) ) * <span class="hljs-number">43758.5453</span> );<br>&#125;<br><br><span class="hljs-function">vec2 <span class="hljs-title">rand2</span><span class="hljs-params">(vec2 st)</span></span>&#123;<br>    st = <span class="hljs-built_in">vec2</span>( <span class="hljs-built_in">dot</span>(st,<span class="hljs-built_in">vec2</span>(<span class="hljs-number">127.1</span>,<span class="hljs-number">311.7</span>)), <span class="hljs-built_in">dot</span>(st,<span class="hljs-built_in">vec2</span>(<span class="hljs-number">269.5</span>,<span class="hljs-number">183.3</span>)) );<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1.0</span> + <span class="hljs-number">2.0</span>*<span class="hljs-built_in">fract</span>(<span class="hljs-built_in">sin</span>(st)*<span class="hljs-number">43758.5453123</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">noise</span> <span class="hljs-params">(in vec2 st)</span> </span>&#123;<br>    vec2 i = <span class="hljs-built_in">floor</span>(st);<br>    vec2 f = <span class="hljs-built_in">fract</span>(st);<br>    vec2 u = f*f*(<span class="hljs-number">3.0</span><span class="hljs-number">-2.0</span>*f);<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">mix</span>( <span class="hljs-built_in">mix</span>( <span class="hljs-built_in">dot</span>( <span class="hljs-built_in">rand2</span>(i + <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>) ), f - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>) ), <span class="hljs-built_in">dot</span>( <span class="hljs-built_in">rand2</span>(i + <span class="hljs-built_in">vec2</span>(<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>) ), f - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>) ), u.x),<br>                <span class="hljs-built_in">mix</span>( <span class="hljs-built_in">dot</span>( <span class="hljs-built_in">rand2</span>(i + <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>) ), f - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>) ), <span class="hljs-built_in">dot</span>( <span class="hljs-built_in">rand2</span>(i + <span class="hljs-built_in">vec2</span>(<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>) ), f - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>) ), u.x), u.y);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">circle</span><span class="hljs-params">(vec2 pos, <span class="hljs-keyword">float</span> radius, <span class="hljs-keyword">float</span> glow)</span></span>&#123;<br>    <span class="hljs-keyword">float</span> sdf = <span class="hljs-built_in">length</span>(pos);<br>    sdf = <span class="hljs-built_in">smoothstep</span>(radius<span class="hljs-number">-0.700</span>,radius,sdf);<br>    <span class="hljs-keyword">float</span> circles = <span class="hljs-number">1.0</span> - <span class="hljs-built_in">smoothstep</span>(<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>,sdf*<span class="hljs-number">10.280</span>);<br>    <span class="hljs-keyword">float</span> glows = <span class="hljs-built_in">exp</span>(-sdf*<span class="hljs-number">4.496</span>) * glow * (<span class="hljs-number">1.0</span> - circles);<br>    <span class="hljs-keyword">return</span> circles+glows;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 st = (gl_FragCoord.xy - <span class="hljs-number">0.5</span> * u_resolution.xy ) / u_resolution.y;<br>    st *= <span class="hljs-number">20.0</span>;<br>    vec2 uv = st;<br>    <span class="hljs-keyword">float</span> noisest = <span class="hljs-built_in">noise</span>(<span class="hljs-built_in">vec2</span>(uv.x - u_time, uv.y - u_time));<br>    uv += noisest*<span class="hljs-number">0.13</span>;<br>    uv += <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">noise</span>(<span class="hljs-built_in">vec2</span>(u_time) * <span class="hljs-number">0.2</span>) * <span class="hljs-number">6.0</span>, -u_time * <span class="hljs-number">2.0</span>);<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.</span>);<br>    vec2 pos = <span class="hljs-built_in">fract</span>(uv)<span class="hljs-number">-0.5</span>;<br>    vec2 id = <span class="hljs-built_in">floor</span>(uv);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> y = <span class="hljs-number">-1</span>; y &lt;= <span class="hljs-number">1</span>; y++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> x = <span class="hljs-number">-1</span>; x &lt;= <span class="hljs-number">1</span>; x++)&#123;<br>            vec2 neighbour = <span class="hljs-built_in">vec2</span>(x,y);<br>            vec2 rand2 = <span class="hljs-built_in">rand2</span>(id+neighbour);<br>            <span class="hljs-keyword">float</span> a = <span class="hljs-built_in">noise</span>(rand2 + u_time * <span class="hljs-number">2.8</span>);<br>            vec2 offset = <span class="hljs-number">0.5</span>*(<span class="hljs-built_in">sin</span>(u_time + rand2*<span class="hljs-number">6.28</span>))*<span class="hljs-number">2.2</span>;<br>            <span class="hljs-keyword">float</span> size = <span class="hljs-built_in">rand</span>(id+neighbour)*<span class="hljs-number">0.75</span> + a*<span class="hljs-number">0.15</span>;<br>            color += <span class="hljs-built_in">circle</span>(pos-neighbour+offset,size,size*<span class="hljs-number">1.400</span>)/<span class="hljs-number">9.0</span> * <span class="hljs-built_in">vec3</span>(rand2.x*<span class="hljs-number">7.884</span>,<span class="hljs-number">7.2</span>,rand2.y*<span class="hljs-number">6.832</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">float</span> xRange = <span class="hljs-number">1.0</span> - <span class="hljs-built_in">abs</span>(<span class="hljs-number">2.0</span> * st.x)*<span class="hljs-number">0.02</span>;<br>    vec3 ambient = <span class="hljs-built_in">smoothstep</span>(<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>,st.y*<span class="hljs-number">0.05</span>+<span class="hljs-number">0.9</span>) * <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.401</span>,<span class="hljs-number">0.570</span>,<span class="hljs-number">0.443</span>);<br>    color = <span class="hljs-built_in">max</span>(ambient, color) * xRange;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(color,<span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif21.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="液态光斑"><a href="#液态光斑" class="headerlink" title="液态光斑"></a>液态光斑</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-keyword">const</span> vec4 col1 = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>);<br><span class="hljs-keyword">const</span> vec4 col2 = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 uv = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">float</span> s = <span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">0.1</span>);<br>    <span class="hljs-keyword">float</span> s2 = <span class="hljs-number">.25</span>+<span class="hljs-built_in">sin</span>(u_time*<span class="hljs-number">1.8</span>);<br>    vec2 d = uv*(<span class="hljs-number">4.0</span>+s*<span class="hljs-number">.3</span>);<br>    <br>    d.x += u_time*<span class="hljs-number">0.25</span>+<span class="hljs-built_in">sin</span>(d.y + u_time*<span class="hljs-number">0.3</span>)*<span class="hljs-number">0.5</span>;<br>    d.y += u_time*<span class="hljs-number">0.25</span>+<span class="hljs-built_in">sin</span>(d.x + u_time*<span class="hljs-number">0.3</span>)*<span class="hljs-number">0.5</span>;<br>    <span class="hljs-keyword">float</span> v1=<span class="hljs-built_in">length</span>(<span class="hljs-number">0.5</span>-<span class="hljs-built_in">fract</span>(d.yx))+<span class="hljs-number">0.95</span>;<br>    <br>    <span class="hljs-keyword">float</span> zoom = <span class="hljs-number">0.42</span>;<br>    d = (<span class="hljs-number">1.0</span>+zoom)*<span class="hljs-number">0.5</span>-(uv*zoom);<br>    <span class="hljs-keyword">float</span> v2=<span class="hljs-built_in">length</span>(<span class="hljs-number">0.5</span>-<span class="hljs-built_in">fract</span>(d.xy));<br>    v1 *= <span class="hljs-number">1.0</span>-v2*v1*<span class="hljs-number">1.64</span>;<br>    v1 = v1*v1*v1;<br>    v1 *= <span class="hljs-number">1.9</span>+s2*<span class="hljs-number">0.2</span>;<br>    gl_FragColor = <span class="hljs-built_in">mix</span>(col2,col1,v1)*(<span class="hljs-number">10.</span>+(s2*<span class="hljs-number">.2</span>));<br>    vec3 _col = <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">mod</span>( uv.x + uv.y, <span class="hljs-number">.0</span>)*<span class="hljs-number">0.002</span>);<br>    gl_FragColor += <span class="hljs-built_in">vec4</span>(_col, <span class="hljs-number">1.</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif22.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="三维线"><a href="#三维线" class="headerlink" title="三维线"></a>三维线</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 R=u_resolution.xy,<br>    U=(gl_FragCoord.xy<span class="hljs-number">-.5</span>*R.xy)/R.y;<br>    <span class="hljs-keyword">float</span> D,t=u_time;<br>    vec3 P,B = <span class="hljs-built_in">normalize</span>( <span class="hljs-built_in">vec3</span>( U.x, U.y,<span class="hljs-number">1</span>) );<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i&lt;<span class="hljs-number">64</span>;i++) &#123;<br>        P = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">sin</span>(U.x*<span class="hljs-number">5.</span>+t), <span class="hljs-number">-5</span>)+ B*D;<br>        P.z-=t*<span class="hljs-number">6.</span>; <br>        P=<span class="hljs-built_in">mod</span>(P,<span class="hljs-number">3.</span>)<span class="hljs-number">-1.5</span>;<br>        P.z -= <span class="hljs-built_in">clamp</span>( P.z, <span class="hljs-number">0.</span>, <span class="hljs-number">5.</span> );<br>        D+=<span class="hljs-built_in">length</span>(P) - <span class="hljs-number">.05</span>;<br>    &#125;<br>    <span class="hljs-keyword">float</span> c = ((D&lt; <span class="hljs-number">16.</span>) ? <span class="hljs-number">1.</span>:<span class="hljs-number">0.</span>);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(c, c, <span class="hljs-number">.0</span>, <span class="hljs-number">1.0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif23.gif" srcset="/img/loading.gif" lazyload></p>
<h3 id="图片Shader实例"><a href="#图片Shader实例" class="headerlink" title="图片Shader实例"></a>图片Shader实例</h3><h4 id="测试图片"><a href="#测试图片" class="headerlink" title="测试图片"></a>测试图片</h4><p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic08.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="高斯模糊"><a href="#高斯模糊" class="headerlink" title="高斯模糊"></a>高斯模糊</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">normpdf</span><span class="hljs-params">(in <span class="hljs-keyword">float</span> x, in <span class="hljs-keyword">float</span> sigma)</span> </span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0.39894</span>*<span class="hljs-built_in">exp</span>(<span class="hljs-number">-0.5</span>*x*x/(sigma*sigma))/sigma;<br>&#125;<br><br><span class="hljs-function">vec3 <span class="hljs-title">gaussianBlur</span><span class="hljs-params">(sampler2D tex, vec2 coord, vec2 res, <span class="hljs-keyword">int</span> amount)</span> </span>&#123;<br>    <span class="hljs-comment">//declare stuff</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> mSize = <span class="hljs-number">22</span>;<br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> kSize = (mSize<span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">float</span> kernel[mSize];<br>    vec3 final_colour = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.0</span>);<br><br>    <span class="hljs-comment">//create the 1-D kernel</span><br>    <span class="hljs-keyword">float</span> sigma = <span class="hljs-number">7.0</span>;<br>    <span class="hljs-keyword">float</span> Z = <span class="hljs-number">0.0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= kSize; ++j) &#123;<br>        kernel[kSize+j] = kernel[kSize-j] = <span class="hljs-built_in">normpdf</span>(<span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(j), sigma);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; mSize; ++j) &#123;<br>        Z += kernel[j];<br>    &#125;<br><br>    <span class="hljs-comment">//read out the texels</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=-kSize; i &lt;= kSize; ++i) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=-kSize; j &lt;= kSize; ++j) &#123;<br>            final_colour += kernel[kSize+j]*kernel[kSize+i]*<span class="hljs-built_in">texture2D</span>(u_tex0, (coord.xy+<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(i),<span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(j))) / res.xy).rgb;<br><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> final_colour/(Z*Z);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 uv = gl_FragCoord.xy / u_resolution;<br>	vec4 c = <span class="hljs-built_in">texture2D</span>(u_tex0, uv);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(<span class="hljs-built_in">gaussianBlur</span>(u_tex0, gl_FragCoord.xy, u_resolution.xy, <span class="hljs-number">11</span>), c.a);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic20.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="噪点图片"><a href="#噪点图片" class="headerlink" title="噪点图片"></a>噪点图片</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br><br><span class="hljs-keyword">float</span> amount = <span class="hljs-number">0.8</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">random2d</span><span class="hljs-params">(vec2 coord)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">sin</span>(<span class="hljs-built_in">dot</span>(coord.xy, <span class="hljs-built_in">vec2</span>(<span class="hljs-number">12.9898</span>, <span class="hljs-number">78.233</span>))) * <span class="hljs-number">43758.5453</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 color = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">.0</span>);<br>    vec4 image = <span class="hljs-built_in">texture2D</span>(u_tex0, coord);<br>    <span class="hljs-keyword">float</span> noise = (<span class="hljs-built_in">random2d</span>(coord) - <span class="hljs-number">.5</span>) * amount;<br>    image.r += noise;<br>    image.g += noise;<br>    image.b += noise;<br>    gl_FragColor = image;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic09.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="去色"><a href="#去色" class="headerlink" title="去色"></a>去色</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec4 texColor = <span class="hljs-built_in">texture2D</span>(u_tex0, coord);<br>    vec3 lum = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0.299</span>, <span class="hljs-number">0.587</span>, <span class="hljs-number">0.114</span>);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(<span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">dot</span>(texColor.rgb, lum)), texColor.a);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic11.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="图片混合流动"><a href="#图片混合流动" class="headerlink" title="图片混合流动"></a>图片混合流动</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br>uniform sampler2D u_tex1;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 col = <span class="hljs-number">0.5</span> + <span class="hljs-number">0.5</span> * <span class="hljs-built_in">cos</span>(u_time + coord.xyx + <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>));<br>    vec4 disp = <span class="hljs-built_in">texture2D</span>(u_tex0, coord + <span class="hljs-built_in">vec2</span>(u_time * <span class="hljs-number">0.01</span>, u_time * <span class="hljs-number">0.02</span>));<br>    <span class="hljs-keyword">float</span> resx = u_resolution.x;<br>    <span class="hljs-keyword">float</span> resy = u_resolution.y;<br>    vec2 center = (<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(u_time) * resx * <span class="hljs-number">0.75</span> * <span class="hljs-number">0.5</span>, <span class="hljs-built_in">cos</span>(u_time) * resy * <span class="hljs-number">0.6</span> * <span class="hljs-number">0.5</span>) + <br>                   <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(<span class="hljs-number">2.0</span>*u_time) * resx * <span class="hljs-number">0.25</span> * <span class="hljs-number">0.5</span>, <span class="hljs-built_in">cos</span>(<span class="hljs-number">2.0</span>*u_time) * resy * <span class="hljs-number">0.4</span> * <span class="hljs-number">0.5</span>) +<br>                   <span class="hljs-built_in">vec2</span>(resx * <span class="hljs-number">0.5</span>, resy * <span class="hljs-number">0.5</span>));<br>    <span class="hljs-keyword">float</span> dist = <span class="hljs-built_in">length</span>(gl_FragCoord.xy - center);<br>    <span class="hljs-keyword">float</span> mag = <span class="hljs-built_in">exp</span>(-dist * (<span class="hljs-number">0.01</span> + <span class="hljs-number">0.005</span> * <span class="hljs-built_in">sin</span>(u_time)));<br>    disp = disp * mag;<br>    vec4 image = <span class="hljs-built_in">texture2D</span>(u_tex1, coord);<br>    vec4 col2 = <span class="hljs-built_in">texture2D</span>(u_tex1, coord + disp.rg * <span class="hljs-number">0.2</span>);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(col2.xyz, image.a);<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif25.gif" srcset="/img/loading.gif" lazyload></p>
<h4 id="马赛克"><a href="#马赛克" class="headerlink" title="马赛克"></a>马赛克</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br>uniform vec2 u_tex0Resolution;<br><br><span class="hljs-keyword">const</span> vec2 pixelSize = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">5.0</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec3 c;<br>    vec4 src = <span class="hljs-built_in">texture2D</span>(u_tex0, coord);<br>	vec3 sum;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> a=<span class="hljs-number">0</span>;a&lt;<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(pixelSize.x);a++) &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> b=<span class="hljs-number">0</span>;b&lt;<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(pixelSize.y);b++) &#123;<br>            c = <span class="hljs-built_in">texture2D</span>(u_tex0, (gl_FragCoord.xy-<span class="hljs-built_in">mod</span>(gl_FragCoord.xy, pixelSize) + <span class="hljs-built_in">vec2</span>(a,b)) / u_resolution.xy).rgb;<br>            sum += c;<br>        &#125;<br>    &#125;<br>    sum /= pixelSize.x * pixelSize.y;<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(sum, src.a);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic13.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="【抖音】特效1"><a href="#【抖音】特效1" class="headerlink" title="【抖音】特效1"></a>【抖音】特效1</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> PI = <span class="hljs-number">3.1415926</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> duration = <span class="hljs-number">2.0</span>;<br><br><span class="hljs-function">vec4 <span class="hljs-title">getMask</span><span class="hljs-params">(<span class="hljs-keyword">float</span> time, vec2 textureCoords, <span class="hljs-keyword">float</span> padding)</span> </span>&#123;<br>    vec2 translation = <span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">sin</span>(time * (PI * <span class="hljs-number">2.0</span> / duration)),<br>                            <span class="hljs-built_in">cos</span>(time * (PI * <span class="hljs-number">2.0</span> / duration)));<br>    vec2 translationTextureCoords = textureCoords + padding * translation;<br>    vec4 mask = <span class="hljs-built_in">texture2D</span>(u_tex0, translationTextureCoords);<br><br>    <span class="hljs-keyword">return</span> mask;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">maskAlphaProgress</span><span class="hljs-params">(<span class="hljs-keyword">float</span> currentTime, <span class="hljs-keyword">float</span> hideTime, <span class="hljs-keyword">float</span> startTime)</span> </span>&#123;<br>    <span class="hljs-keyword">float</span> time = <span class="hljs-built_in">mod</span>(duration + currentTime - startTime, duration);<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(time, hideTime);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">float</span> time = <span class="hljs-built_in">mod</span>(u_time, duration);<br>    <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.1</span>;<br>    <span class="hljs-keyword">float</span> padding = <span class="hljs-number">0.3</span> * (<span class="hljs-number">1.0</span> - <span class="hljs-number">1.0</span> / scale);<br>    vec2 textureCoords = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>) + (coord - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>)) / scale;<br><br>    <span class="hljs-keyword">float</span> hideTime = <span class="hljs-number">0.9</span>;<br>    <span class="hljs-keyword">float</span> timeGap = <span class="hljs-number">0.12</span>;<br><br>    <span class="hljs-keyword">float</span> maxAlphaR = <span class="hljs-number">0.4</span>; <span class="hljs-comment">// max R</span><br>    <span class="hljs-keyword">float</span> maxAlphaG = <span class="hljs-number">0.01</span>; <span class="hljs-comment">// max G</span><br>    <span class="hljs-keyword">float</span> maxAlphaB = <span class="hljs-number">0.02</span>; <span class="hljs-comment">// max B</span><br><br>    vec4 mask = <span class="hljs-built_in">getMask</span>(time, textureCoords, padding);<br>    <span class="hljs-keyword">float</span> alphaR = <span class="hljs-number">1.0</span>; <span class="hljs-comment">// R</span><br>    <span class="hljs-keyword">float</span> alphaG = <span class="hljs-number">1.0</span>; <span class="hljs-comment">// G</span><br>    <span class="hljs-keyword">float</span> alphaB = <span class="hljs-number">1.0</span>; <span class="hljs-comment">// B</span><br><br>    vec4 resultMask;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">float</span> f = <span class="hljs-number">0.0</span>; f &lt; duration; f += timeGap) &#123;<br>        <span class="hljs-keyword">float</span> tmpTime = f;<br>        vec4 tmpMask = <span class="hljs-built_in">getMask</span>(tmpTime, textureCoords, padding);<br>        <span class="hljs-keyword">float</span> tmpAlphaR = maxAlphaR - maxAlphaR * <span class="hljs-built_in">maskAlphaProgress</span>(time, hideTime, tmpTime) / hideTime;<br>        <span class="hljs-keyword">float</span> tmpAlphaG = maxAlphaG - maxAlphaG * <span class="hljs-built_in">maskAlphaProgress</span>(time, hideTime, tmpTime) / hideTime;<br>        <span class="hljs-keyword">float</span> tmpAlphaB = maxAlphaB - maxAlphaB * <span class="hljs-built_in">maskAlphaProgress</span>(time, hideTime, tmpTime) / hideTime;<br><br>        resultMask += <span class="hljs-built_in">vec4</span>(tmpMask.r * tmpAlphaR,<br>                           tmpMask.g * tmpAlphaG,<br>                           tmpMask.b * tmpAlphaB,<br>                        <span class="hljs-number">1.0</span>);<br>        alphaR -= tmpAlphaR;<br>        alphaG -= tmpAlphaG;<br>        alphaB -= tmpAlphaB;<br>    &#125;<br>    resultMask += <span class="hljs-built_in">vec4</span>(mask.r * alphaR, mask.g * alphaG, mask.b * alphaB, <span class="hljs-number">1.0</span>);<br>    gl_FragColor = resultMask;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic14.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="【抖音】特效2"><a href="#【抖音】特效2" class="headerlink" title="【抖音】特效2"></a>【抖音】特效2</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br>uniform vec2 u_tex0Resolution;<br><br><span class="hljs-keyword">float</span> duration = <span class="hljs-number">1.2</span>;<br><span class="hljs-keyword">float</span> maxAlpha = <span class="hljs-number">0.6</span>;<br><span class="hljs-keyword">float</span> maxScale = <span class="hljs-number">1.5</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec4 color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">.0</span>);<br>    <span class="hljs-keyword">float</span> progress = <span class="hljs-built_in">mod</span>(u_time, duration) / duration;<br>    <span class="hljs-keyword">float</span> alpha = maxAlpha * (<span class="hljs-number">1.0</span> - progress);<br>    <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> + (maxScale - <span class="hljs-number">1.0</span>) * progress;<br>    <span class="hljs-keyword">float</span> weakX = <span class="hljs-number">0.5</span> + (coord.x - <span class="hljs-number">0.5</span>) / scale;<br>    <span class="hljs-keyword">float</span> weakY = <span class="hljs-number">0.5</span> + (coord.y - <span class="hljs-number">0.5</span>) / scale;<br>    vec2 weakTextureCoords = <span class="hljs-built_in">vec2</span>(weakX, weakY);<br>    vec4 weakImage = <span class="hljs-built_in">texture2D</span>(u_tex0, weakTextureCoords);<br>    vec4 maskImage = <span class="hljs-built_in">texture2D</span>(u_tex0, coord);<br>    gl_FragColor = maskImage * (<span class="hljs-number">1.0</span> - alpha) + weakImage * alpha;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic15.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="【抖音】特效3"><a href="#【抖音】特效3" class="headerlink" title="【抖音】特效3"></a>【抖音】特效3</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br><br><span class="hljs-keyword">float</span> duration = <span class="hljs-number">0.65</span>;<br><span class="hljs-keyword">float</span> maxScale = <span class="hljs-number">1.2</span>;<br><span class="hljs-keyword">float</span> offset = <span class="hljs-number">0.025</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec4 color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">.0</span>);<br>    <span class="hljs-keyword">float</span> progress = <span class="hljs-built_in">mod</span>(u_time, duration) / duration;<br>    vec2 offsetCoord = <span class="hljs-built_in">vec2</span>(offset) * progress;<br>    <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> + (maxScale - <span class="hljs-number">1.0</span>) * progress;<br>    vec2 scaleTextureCoords = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>) + (coord - <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>)) / scale;<br>    vec4 maskR = <span class="hljs-built_in">texture2D</span>(u_tex0, scaleTextureCoords + offsetCoord);<br>    vec4 maskB = <span class="hljs-built_in">texture2D</span>(u_tex0, scaleTextureCoords - offsetCoord);<br>    vec4 mask = <span class="hljs-built_in">texture2D</span>(u_tex0, scaleTextureCoords);<br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(maskR.r, mask.g, maskB.b, mask.a);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic16.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="【抖音】特效4"><a href="#【抖音】特效4" class="headerlink" title="【抖音】特效4"></a>【抖音】特效4</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> PI = <span class="hljs-number">3.1415926</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> maxJitter = <span class="hljs-number">0.06</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> duration = <span class="hljs-number">0.3</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> colorROffset = <span class="hljs-number">0.01</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> colorBOffset = <span class="hljs-number">-0.025</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">rand</span><span class="hljs-params">(<span class="hljs-keyword">float</span> n)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fract</span>(<span class="hljs-built_in">sin</span>(n) * <span class="hljs-number">43758.5453123</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">float</span> time = <span class="hljs-built_in">mod</span>(u_time, duration * <span class="hljs-number">2.0</span>);<br>    <span class="hljs-keyword">float</span> amplitude = <span class="hljs-built_in">max</span>(<span class="hljs-built_in">sin</span>(time * (PI / duration)), <span class="hljs-number">0.0</span>);<br><br>    <span class="hljs-keyword">float</span> jitter = <span class="hljs-built_in">rand</span>(coord.y) * <span class="hljs-number">2.0</span> - <span class="hljs-number">1.0</span>; <span class="hljs-comment">// -1~1</span><br>    <span class="hljs-keyword">bool</span> needOffset = <span class="hljs-built_in">abs</span>(jitter) &lt; maxJitter * amplitude;<br><br>    <span class="hljs-keyword">float</span> textureX = coord.x + (needOffset ? jitter : (jitter * amplitude * <span class="hljs-number">0.006</span>));<br>    vec2 textureCoords = <span class="hljs-built_in">vec2</span>(textureX, coord.y);<br><br>    vec4 mask = <span class="hljs-built_in">texture2D</span>(u_tex0, textureCoords);<br>    vec4 maskR = <span class="hljs-built_in">texture2D</span>(u_tex0, textureCoords + <span class="hljs-built_in">vec2</span>(colorROffset * amplitude, <span class="hljs-number">0.0</span>));<br>    vec4 maskB = <span class="hljs-built_in">texture2D</span>(u_tex0, textureCoords + <span class="hljs-built_in">vec2</span>(colorBOffset * amplitude, <span class="hljs-number">0.0</span>));<br><br>    gl_FragColor = <span class="hljs-built_in">vec4</span>(maskR.r, mask.g, maskB.b, mask.a);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic17.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="浮雕"><a href="#浮雕" class="headerlink" title="浮雕"></a>浮雕</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform sampler2D u_tex0;<br>uniform vec2 u_resolution;<br>uniform vec2 u_tex0Resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> dir = <span class="hljs-number">60.</span>; <br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> dist = <span class="hljs-number">0.006</span>; <br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> strength = <span class="hljs-number">2.</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> invert = <span class="hljs-number">1.</span>; <span class="hljs-comment">//0, 1</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> BnW = <span class="hljs-number">1.</span>; <span class="hljs-comment">//Black and white? 0, 1</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    vec2 uv = gl_FragCoord.xy / u_resolution.xy;<br>    vec4 image = <span class="hljs-built_in">texture2D</span>(u_tex0, uv);<br>    vec4 color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0.</span>);<br>    <span class="hljs-keyword">if</span> (invert &lt; <span class="hljs-number">1.</span>) &#123;<br>	    color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0.5</span> + ((<span class="hljs-built_in">texture2D</span>(u_tex0, uv).rgb - <span class="hljs-built_in">texture2D</span>(u_tex0, uv + (<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(<span class="hljs-built_in">radians</span>(dir)), <span class="hljs-built_in">sin</span>(<span class="hljs-built_in">radians</span>(dir))) * dist)).rgb) * strength), <span class="hljs-number">1.0</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        color = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0.5</span> + ((<span class="hljs-built_in">texture2D</span>(u_tex0, uv + (<span class="hljs-built_in">vec2</span>(<span class="hljs-built_in">cos</span>(<span class="hljs-built_in">radians</span>(dir)), <span class="hljs-built_in">sin</span>(<span class="hljs-built_in">radians</span>(dir))) * dist)).rgb - <span class="hljs-built_in">texture2D</span>(u_tex0, uv).rgb) * strength), <span class="hljs-number">1.0</span>);    <br>    &#125;<br>    <span class="hljs-keyword">if</span> (BnW &gt;= <span class="hljs-number">1.</span>) &#123; <br>        color = <span class="hljs-built_in">vec4</span>((color.r + color.g + color.b) / <span class="hljs-built_in">vec3</span>(<span class="hljs-number">3.</span>), color.a);<br>    &#125;<br>    gl_FragColor = color;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic19.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="描边"><a href="#描边" class="headerlink" title="描边"></a>描边</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br>uniform vec2 u_tex0Resolution;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> outlineSize = <span class="hljs-number">3.0</span>;<br><span class="hljs-keyword">const</span> vec3 outlineColor = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.298</span>);<br><span class="hljs-keyword">const</span> vec3 foregroundColor = <span class="hljs-built_in">vec3</span>(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>);<br><br><span class="hljs-comment">// 判断在这个角度上距离为outlineSize那一点是不是透明  </span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getIsStrokeWithAngel</span><span class="hljs-params">(<span class="hljs-keyword">float</span> angel)</span> </span>&#123;  <br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">int</span> stroke = <span class="hljs-number">0</span>;  <br>    <span class="hljs-keyword">float</span> rad = angel * <span class="hljs-number">0.01745329252</span>; <span class="hljs-comment">// 这个浮点数是 pi / 180，角度转弧度  </span><br>    <span class="hljs-keyword">float</span> a = <span class="hljs-built_in">texture2D</span>(u_tex0, <span class="hljs-built_in">vec2</span>(coord.x + outlineSize * <span class="hljs-built_in">cos</span>(rad) / u_resolution.x, coord.y + outlineSize * <span class="hljs-built_in">sin</span>(rad) / u_resolution.y)).a; <span class="hljs-comment">// 这句比较难懂，outlineSize * cos(rad)可以理解为在x轴上投影，除以textureSize.x是因为texture2D接收的是一个0~1的纹理坐标，而不是像素坐标  </span><br>    <span class="hljs-keyword">if</span> (a &gt;= <span class="hljs-number">0.5</span>)<span class="hljs-comment">// 我把alpha值大于0.5都视为不透明，小于0.5都视为透明  </span><br>    &#123;  <br>        stroke = <span class="hljs-number">1</span>;  <br>    &#125;  <br>    <span class="hljs-keyword">return</span> stroke;  <br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 coord = gl_FragCoord.xy / u_resolution;<br>    vec4 myC = <span class="hljs-built_in">texture2D</span>(u_tex0, <span class="hljs-built_in">vec2</span>(coord.x, coord.y)); <span class="hljs-comment">// 正在处理的这个像素点的颜色  </span><br>    myC.rgb *= foregroundColor;  <br>    <span class="hljs-keyword">if</span> (myC.a &gt;= <span class="hljs-number">0.5</span>) &#123;  <br>        gl_FragColor = myC;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">int</span> strokeCount = <span class="hljs-number">0</span>;  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">0.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">30.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">60.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">90.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">120.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">150.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">180.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">210.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">240.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">270.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">300.0</span>);  <br>    strokeCount += <span class="hljs-built_in">getIsStrokeWithAngel</span>(<span class="hljs-number">330.0</span>);  <br>    <span class="hljs-keyword">if</span> (strokeCount &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">// 四周围至少有一个点是不透明的，这个点要设成描边颜色  </span><br>    &#123;  <br>        myC.rgb = outlineColor;<br>        <span class="hljs-comment">// myC.r = sin(u_time / 5.0 + cos(u_time * 3.0));</span><br>        <span class="hljs-comment">// myC.g = cos(u_time / 3.0 + sin(u_time * 5.0));</span><br>        myC.a = <span class="hljs-number">1.0</span>;  <br>    &#125;  <br>    gl_FragColor = myC;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic12.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="卡通效果"><a href="#卡通效果" class="headerlink" title="卡通效果"></a>卡通效果</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform sampler2D u_tex0;<br>uniform vec2 u_resolution;<br>uniform <span class="hljs-keyword">float</span> u_time;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GAMMA 1.0</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> RATE 6.0</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> POWER 6.0</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EPSILON 1e-9</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> T(d) pow(texture2D(u_tex0, fract(d)),vec4(GAMMA))</span><br><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">reset</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">texture2D</span>(u_tex0, <span class="hljs-built_in">vec2</span>(<span class="hljs-number">32.5</span>/<span class="hljs-number">256.0</span>, <span class="hljs-number">0.5</span>) ).x &gt; <span class="hljs-number">0.5</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _K0 = <span class="hljs-number">-20.0</span>/<span class="hljs-number">6.0</span>; <span class="hljs-comment">// center weight</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _K1 = <span class="hljs-number">4.0</span>/<span class="hljs-number">6.0</span>;   <span class="hljs-comment">// edge-neighbors</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _K2 = <span class="hljs-number">1.0</span>/<span class="hljs-number">6.0</span>;   <span class="hljs-comment">// vertex-neighbors</span><br>    <br>    vec2 vUv = gl_FragCoord.xy / u_resolution;<br>    vec2 texel = <span class="hljs-number">1.</span> / u_resolution.xy;<br>    <br>    <span class="hljs-comment">// 3x3 neighborhood coordinates</span><br>    <span class="hljs-keyword">float</span> step_x = texel.x;<br>    <span class="hljs-keyword">float</span> step_y = texel.y;<br>    vec2 n  = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>, step_y);<br>    vec2 ne = <span class="hljs-built_in">vec2</span>(step_x, step_y);<br>    vec2 e  = <span class="hljs-built_in">vec2</span>(step_x, <span class="hljs-number">0.0</span>);<br>    vec2 se = <span class="hljs-built_in">vec2</span>(step_x, -step_y);<br>    vec2 s  = <span class="hljs-built_in">vec2</span>(<span class="hljs-number">0.0</span>, -step_y);<br>    vec2 sw = <span class="hljs-built_in">vec2</span>(-step_x, -step_y);<br>    vec2 w  = <span class="hljs-built_in">vec2</span>(-step_x, <span class="hljs-number">0.0</span>);<br>    vec2 nw = <span class="hljs-built_in">vec2</span>(-step_x, step_y);<br>    vec4 u = <span class="hljs-built_in">T</span>(vUv);<br>    <br>    vec4 u_nb[<span class="hljs-number">8</span>];<br>    u_nb[<span class="hljs-number">0</span>] = <span class="hljs-built_in">T</span>(vUv+n);<br>    u_nb[<span class="hljs-number">1</span>] = <span class="hljs-built_in">T</span>(vUv+e);<br>    u_nb[<span class="hljs-number">2</span>] = <span class="hljs-built_in">T</span>(vUv+s);<br>    u_nb[<span class="hljs-number">3</span>] = <span class="hljs-built_in">T</span>(vUv+w);<br>    u_nb[<span class="hljs-number">4</span>] = <span class="hljs-built_in">T</span>(vUv+nw);<br>    u_nb[<span class="hljs-number">5</span>] = <span class="hljs-built_in">T</span>(vUv+sw);<br>    u_nb[<span class="hljs-number">6</span>] = <span class="hljs-built_in">T</span>(vUv+ne);<br>    u_nb[<span class="hljs-number">7</span>] = <span class="hljs-built_in">T</span>(vUv+se);<br>    <span class="hljs-keyword">float</span> k[<span class="hljs-number">8</span>];<br>    k[<span class="hljs-number">0</span>] = _K1;<br>    k[<span class="hljs-number">1</span>] = _K1;<br>    k[<span class="hljs-number">2</span>] = _K1;<br>    k[<span class="hljs-number">3</span>] = _K1;<br>    k[<span class="hljs-number">4</span>] = _K2;<br>    k[<span class="hljs-number">5</span>] = _K2;<br>    k[<span class="hljs-number">6</span>] = _K2;<br>    k[<span class="hljs-number">7</span>] = _K2;<br>    vec4 m[<span class="hljs-number">8</span>];<br>    vec4 sum = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        vec4 f = k[i] / (EPSILON + <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">abs</span>(u_nb[i] - u), <span class="hljs-built_in">vec4</span>(POWER))); <br>    	m[i] = f;<br>        sum += f;<br>    &#125;<br>    <br>    vec4 lapl = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>    	lapl += m[i] * u_nb[i] / sum;<br>    &#125;<br>    <br>    lapl -= u;<br>    gl_FragColor = <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">vec4</span>(u + RATE*lapl),<span class="hljs-built_in">vec4</span>(<span class="hljs-number">1.0</span>/GAMMA));<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/pic18.jpg" srcset="/img/loading.gif" lazyload></p>
<h4 id="UV动画"><a href="#UV动画" class="headerlink" title="UV动画"></a>UV动画</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> GL_ES</span><br>precision mediump <span class="hljs-keyword">float</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>uniform <span class="hljs-keyword">float</span> u_time;<br>uniform vec2 u_resolution;<br>uniform sampler2D u_tex0;<br>uniform vec2 u_tex0Resolution;<br><br>vec4 tint = <span class="hljs-built_in">vec4</span>(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>);<br><span class="hljs-keyword">int</span> tileX = <span class="hljs-number">4</span>;<br><span class="hljs-keyword">int</span> tileY = <span class="hljs-number">4</span>;<br><span class="hljs-keyword">float</span> speed = <span class="hljs-number">30.0</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vec2 uv = gl_FragCoord.xy / u_resolution;<br>    <span class="hljs-keyword">float</span> gridIndex = <span class="hljs-built_in">mod</span>(u_time * speed, <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(tileX * tileY));<br>    <span class="hljs-keyword">int</span> indexY = <span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(gridIndex) / tileX;<br>    <span class="hljs-keyword">int</span> indexX = <span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(gridIndex) - tileX * indexY;<br>    uv = <span class="hljs-built_in">vec2</span>((uv.x + <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(indexX)) / <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(tileX), (uv.y + <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(indexY)) / <span class="hljs-built_in"><span class="hljs-keyword">float</span></span>(tileY));<br>    vec4 image = <span class="hljs-built_in">texture2D</span>(u_tex0, uv);<br>    gl_FragColor = image * tint;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WebGL%E7%9A%84shader%E7%BC%96%E5%86%99/gif26.gif" srcset="/img/loading.gif" lazyload></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/shader/">shader</a>
                    
                      <a class="hover-with-bg" href="/tags/webgl/">webgl</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/7a621609/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">WebGL2的HelloWorld</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/posts/d6ef9114/">
                        <span class="hidden-mobile">三角函数图形表</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        浙ICP备20021627
      </a>
    </span>
    
  </div>


  
    <!-- cnzz Analytics Icon -->
    <span id="cnzz_stat_icon_1260480291" style="display: none"></span>
  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  

  

  

  

  
    <!-- cnzz Analytics -->
    <script defer src="//s4.cnzz.com/z_stat.php?id=1260480291&show=pic"
            type="text/javascript"></script>
  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
